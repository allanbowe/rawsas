---
title: 'Get Physical Path From Metadata Libref'
date: '2015-03-17 13:16:00'
path: '/get-physical-path-from-metadata-libref/'
previewImg: ''
tags:
  - SQL
---

So it turns out that it is not possible to place a SAS lock on a table referenced via the Metadata Libname Engine:<br /><br /><span style="font-family: Courier New, Courier, monospace;">WARNING: LOCK is not supported in MLE.</span><br /><br />To circumvent this issue, one approach is to assign a libref directly. The following macro takes a libref (placed in the lib= keyword parameter) and queries the metadata for a physical path (placed in macro variable specified in the outvar= keyword parameter).<br /><br />Note that not all librefs have an underlying directory (eg database tables).<br /><br /><span style="font-family: Courier New, Courier, monospace;">%macro get*path_from_metalibref(lib=,outvar=filepath);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;data \_null*;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; putlog "NOTE: Getting physical path for &amp;lib library";</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; length lib*uri up_uri filepath \$256;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; call missing (of \_all*);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /_ get URI for the particular library _/</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc1=metadata_getnobj("omsobj:SASLibrary?@Libref ='&amp;lib'",1,lib_uri);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc1= lib_uri= ;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /_ get first object of the UsingPackages association (assumed to be Path) _/</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc2=metadata_getnasn(lib_uri,'UsingPackages',1,up_uri);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc2= up_uri= ;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /_ get the DirectoryName attribute of the previous object _/</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc3=metadata_getattr(up_uri,'DirectoryName',filepath);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc3= filepath=;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; call symputx("&amp;outvar",filepath,'g');</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;run;</span><br /><span style="font-family: Courier New, Courier, monospace;">%mend;</span><div data-bid="11a492c4-afd5-4c83-9bcc-d304573e1386" data-u></div>
