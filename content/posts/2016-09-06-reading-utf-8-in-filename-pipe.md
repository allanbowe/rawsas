---
title: 'Reading UTF-8 in Filename Pipe'
date: '2016-09-06 13:27:00'
path: '/reading-utf-8-in-filename-pipe/'
tags:
  - Movable Type
---

Having been blessed with an en-dash (alt&nbsp;+ 2013) in our TFS project root, I've been having lots of fun getting SAS to 'play nicely' with non-ascii characters when running OS commands (eg tf.exe).<br /><br />Storing the values in macro variables works fine for direct use (eg in an X command), but running a SAS generated .bat file was proving challenging - until I realised that the issue was actually within the windows shell, rather than SAS itself.<br /><br />The solution turned out to be twofold. &nbsp;Firstly, the batch file itself needed to be UTF-8 encoded WITHOUT the BOM marker. &nbsp;This required the&nbsp;<span style="background-color: white; color: blue; font-family: &quot;courier new&quot;;">nobomfile</span>&nbsp; system <a href="http://support.sas.com/documentation/cdl/en/nlsref/61893/HTML/default/viewer.htm#a003105792.htm" target="_blank">option</a>&nbsp;to be in place before creating the file.<br /><br />Secondly, the shell needs to be configured to read UTF-8 characters. &nbsp;This can be done by changing the codepage (using &nbsp;<span style="background-color: #eff0f1; color: #242729; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif; font-size: 13px; white-space: inherit;">chcp 65001</span>) and <a href="http://rawsas.blogspot.co.uk/2016/08/chaining-windows-commands-in-sas.html" target="_blank">chaining</a> with an ampersand.<br /><br />Sample code as follows:<br /><blockquote style="margin-bottom: 0.0001pt;"><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">options</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">nobomfile</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">%let</span><span style="background: white; font-family: &quot;courier new&quot;;"> work=</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">%sysfunc</span><span style="background: white; font-family: &quot;courier new&quot;;">(pathname(work));<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">%let</span><span style="background: white; font-family: &quot;courier new&quot;;"> file=&amp;work/mybatchfile.bat;</span></blockquote>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">data</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">_null_</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">file</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">"&amp;file"</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">encoding</span><span style="background: white; font-family: &quot;courier new&quot;;">=</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'utf-8'</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">put</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">"dir ""&amp;work"" "</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">put</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'echo Nonstandard â€“ Dash'</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;">&nbsp; &nbsp;&nbsp;</span><span style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;">run</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">&nbsp; &nbsp; filename</span><span style="background: white; font-family: &quot;courier new&quot;;"> mypipe </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">pipe</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">"chcp 65001 &amp; ""&amp;file"" "</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><span style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;">&nbsp; &nbsp;&nbsp;</span><span style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;">data</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">_null_</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">infile</span><span style="background: white; font-family: &quot;courier new&quot;;"> mypipe;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">input</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">list</span><span style="background: white; font-family: &quot;courier new&quot;;">;</span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">run</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;</span><br /><br /><div><o:p></o:p></div><br />