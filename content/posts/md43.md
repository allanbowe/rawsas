---
title: 'VBA and SAS IOM - applying formats'
date: '2014-12-29 15:37:00'
layout: post
path: '/vba-and-sas-iom-applying-formats/'
category: Typography
tags:
  - Movable Type
---

Sample code (and tips) for applying SAS Formats to data before pulling into excel:<br /><br /><pre><span style="color: maroon; font-weight: bold;">Dim</span> obConnection <span style="color: maroon; font-weight: bold;">As</span> <span style="color: maroon; font-weight: bold;">New</span> ADODB<span style="color: #008c00;">.</span>Connection<br /><span style="color: maroon; font-weight: bold;">Dim</span> obRecordSet <span style="color: maroon; font-weight: bold;">As</span> <span style="color: maroon; font-weight: bold;">New</span> ADODB<span style="color: #008c00;">.</span>Recordset<br /><br /><span style="color: dimgrey;">'workspace (ws) object previously defined</span><br />obConnection<span style="color: #008c00;">.</span><span style="color: maroon; font-weight: bold;">Open</span> <span style="color: #0000e6;">"provider=sas.iomprovider.1; Data Source=iom-id://"</span> <span style="color: #808030;">+</span> ws<span style="color: #008c00;">.</span>UniqueIdentifier<br />    <br /><span style="color: dimgrey;">'need to set the connection before the format property can be applied</span><br />obRecordSet<span style="color: #008c00;">.</span>ActiveConnection <span style="color: #808030;">=</span> obConnection<br />    <br /><span style="color: dimgrey;">'use "+_ALL_" to get both formatted AND unformatted values</span><br />obRecordSet<span style="color: #008c00;">.</span>Properties<span style="color: #808030;">(</span><span style="color: #0000e6;">"SAS Formats"</span><span style="color: #808030;">)</span> <span style="color: #808030;">=</span> <span style="color: #0000e6;">"_ALL_"</span><br />    <br /><span style="color: dimgrey;">' the second parameter below has to be EMPTY</span><br />obRecordSet<span style="color: #008c00;">.</span><span style="color: maroon; font-weight: bold;">Open</span> sasTable<span style="color: #808030;">,</span> <span style="color: #808030;">,</span> adOpenStatic<span style="color: #808030;">,</span> adLockReadOnly<span style="color: #808030;">,</span> ADODB<span style="color: #008c00;">.</span>adCmdTableDirect<br /></pre>