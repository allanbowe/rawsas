{"componentChunkName":"component---src-templates-post-list-template-tsx","path":"/category/sql/page/2/","result":{"data":{"remark":{"posts":[{"post":{"html":"<p>It is perfectly valid to use <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">min()</span> as a <a href=\"https://support.sas.com/kb/25/279.html\" target=\"_blank\">summary function</a> on character values in <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">proc sql</span>, eg as follows:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> min(name) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br /><br />This is not so, however, when using in an inline context:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"><br /> </span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> min(name,sex) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br />Which gives:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; color: red; font-family: &quot;courier new&quot;;\">ERROR: Function MIN requires a numeric expression as argument 1.</span></div><div><span style=\"background: white; color: red; font-family: &quot;courier new&quot;;\">ERROR: Function MIN requires a numeric expression as argument 2.</span></div></blockquote><div></div><br />So what are the alternatives?  If we were in datastep, we might have had the option of the little-known<a href=\"https://support.sas.com/documentation/cdl/en/lrcon/62955/HTML/default/viewer.htm#a000780367.htm\" target=\"_blank\"> infix operator</a> for min (>&#x3C;):<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  minval=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Less’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">>&#x3C;</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘More’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">>&#x3C;</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Lots’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval=;  </span><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/_ minval=Less _/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div></blockquote><br />As it happens though, the min &#x26; max infix operators are not valid in proc sql.  Another approach, if comparing just two values, would be <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">ifc()</span> - eg:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span>  <span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> ifc(name&#x3C;sex,name,sex) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br /><br />But what if we have more than two values?  In this instance, it becomes necessary to take matters into your own hands!  I’ve gone ahead and rolled up an FCMP function below, which could surely be improved, but does the job when comparing three character values in either data step or proc sql:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><br /><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">fcmp</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">outlib</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=work.myfuncs.test;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">function</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minC(a $, b $, c $) $;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">length</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> result $</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">1000</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    result=a>&#x3C;b>&#x3C;c;</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">    return</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> (result);<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">endsub</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">quit</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">cmplib</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=work.myfuncs;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">x</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Killing’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  y=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Me’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  z=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Softly’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  outvar=minC(x,y,z);</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"><br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> outvar=;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minC(</span><span style=\"background-color: white; color: purple; font-family: &quot;courier new&quot;;\">‘Constant’,</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">name,sex)</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"></div><br /><div><br /></div>Would you deal with the requirement any differently?  Let me know in the comments!<br /><br /></p>","frontmatter":{"title":"Finding MIN (or even MAX) of character variables in SQL","path":"/finding-min-or-even-max-of-character-variables-in-sql/","previewImg":null,"tags":["SQL"],"date":"Nov 08, 2016"}}},{"post":{"html":"<p>Noticed today that our UAT 9.3 environment was failing to execute the SAS <span style=\"font-family: Courier New, Courier, monospace;\">ExportPackage</span> <a href=\"https://support.sas.com/documentation/cdl/en/bisag/64088/HTML/default/viewer.htm#a003261084.htm\" target=\"_blank\" rel=\"noopener\">utility</a>, with the following error returned:</p>\n<blockquote><span style=\"font-family: Courier New, Courier, monospace;\">The export process has failed.  The native implementation module for the security package could not be found in the path.</span></blockquote>\r\nI'd come across this issue <a href=\"https://stackoverflow.com/questions/29901224/using-iwa-with-sas-exportpackage-utility\" target=\"_blank\" rel=\"noopener\">before</a>, and this was (effectively) the same piece of code.  So what gives?  I launched a shell session locally, using the system account (sassrvuat), and reran the command.\n<p><i>It worked.</i></p>\n<p>Hmm..  Must be an issue with the UAT machine (most likely since our 9.3 upgrade as it worked on 9.2).  I logged into sasapp with sassrvuat and tried to open DI Studio using IWA.  I get an interesting popup:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 53.191489361702125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACYUlEQVR42k2S207bQBCG/Za9qHpHCzxCX4TLSkic1Ja2N5VaoYoACTFJHB8SbK8P8dnxOTYJ0F79HVsR4uLTPzs7+69nx9zOMMT+wMPujYO9vku0sYtd0v2Bjw89E+++3+F9z8JeW9d3X9i7drDDx/j4tYdPb9/g88kXcIcsx7mV49TIcMpSIun0RE9wQvHRPMSR7OBYjXCkxh3HGqEuSQmqORNtnF9PcDbSwE0PDuAdHyJLIqjjMZg0hTmTMR/xYKKA+8kE9r0CQ5HgMx2RZSK2DYQmI0zKaTDnMpKyxB8rBqfc3iESRcR5BsZM2AuHWEBjBhauB8vxcK9q8MMID5sNVnXTUTcPLzRNg5xyv3QfXPL0D0/Pf7vkmg48btbwkgqik+BGYpDdDGawxIS+/vKyB0mS4Lou6rpGVVVYrVaoiYIMf7MA3GKZIYsjpGmKvCiwoqI0LxEkOQLaC9MCUZIijiLEcYzlcoksyzrD1qzaGiZFiQsjBCcxC8JohN7VFZhhIKKDnuch8D2EQYAo8Duz6BXtvuO48OhJgjCAT1pS698EGsp4rkESBIxGY0ynIiR6T5Ha4nkeN/0B+OEQY2p3QLEsy/D9ALZtw7JsuGTarl3X6Vr+OXfADeUZxImAiTDtzFpjYTrFkB+RgYIJTbk15O9orSgwTaszM2naqqaT+QILuiCtVrgwI3C67WCh30OfKbA1+gVUFYxiTZlhXZXYrCpsmhrP6waPpE2Roy7oDcscVZaiKQs8EBsaaGd4oXsYmj4GLcZWt/SZ1+X6htfFrd6+qrs1g6366JHPD9nEf3xLBHWzDSeXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 300x159\" title=\"\" src=\"/static/885ea517d55083a228903b2d8732c7df/5a46d/Capture-300x159.png\" srcset=\"/static/885ea517d55083a228903b2d8732c7df/4dcb9/Capture-300x159.png 188w,\n/static/885ea517d55083a228903b2d8732c7df/5a46d/Capture-300x159.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nSeems my old colleague <a href=\"https://no.linkedin.com/in/stig-eide-6364622\" target=\"_blank\" rel=\"noopener\">Stig</a> was onto something with regard to the&nbsp;<b>sspiauth.dll</b> file and 32 vs 64 bit compatibility. &nbsp;Checking out the folder below, we can see several versions:\n<div style=\"clear: both; text-align: center;\"></div>\n<div><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.872340425531917%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVR42h2L2VLCQBBF8/+f5INWoUghCig7FSpkn8lMFggkKMtxMg+n7tJ9HSkEWmvCMMT3faSUliAISJIEpRT7/d6qML9d36G1srs819bHcUxd1zhKl+RFRXu50LYt53NjtLHaNA0X0+uiJBYZcZpRn85UhwM6L+ytMZu6Pplc2uwE2ZHP2Y7pykccrqgzyOODrMbwQJ0gMOXaE2wDjW8OSflrsxvltuty97cNC5x1WPE0dC0v05ix3zJPH8ySu+FmPHx5J97mCf2l5MOtmAYtvZ+Y95Wiv5BMzGaR3nldKJxNVPA8cumNPfqzkHnYsBE31umVtfhjK+98ewcG84jhMmWyK1lEDaONML5g4uYs49ZuBkvJPwqicXTIBX4xAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1 300x69\" title=\"\" src=\"/static/cb8d91f833e53f06f4f58ea911131fae/5a46d/Capture-1-300x69.png\" srcset=\"/static/cb8d91f833e53f06f4f58ea911131fae/4dcb9/Capture-1-300x69.png 188w,\n/static/cb8d91f833e53f06f4f58ea911131fae/5a46d/Capture-1-300x69.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span></div>\nComparing the file sizes it was clear that we had 32 bit DLLs (112kb) instead of 64 (107kb). &nbsp;The solution therefore was simply to copy sspiauth.dll from:\n<blockquote>\n<ul>\n \t<li>C:Program FilesSASHomeSASFoundation9.3coresasext</li>\n</ul>\n</blockquote>\nTo the following locations:\n<blockquote>\n<ul>\n \t<li>C:Program FilesSASHomeSASDataIntegrationStudio4.3</li>\n \t<li>C:Program FilesSASHomeSASPlatformObjectFramework9.3</li>\n</ul>\n</blockquote>\n&nbsp;\n<p> </p>","frontmatter":{"title":"The native implementation module for the security package could not be found in the path.","path":"/the-native-implementation-module-for-the-security-package-could-not-be-found-in-the-path/","previewImg":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/6833f88a6bf3c95adf412b4eaa32aff5/41f14/frontmatter19.png","srcSet":"/static/6833f88a6bf3c95adf412b4eaa32aff5/d4980/frontmatter19.png 108w,\n/static/6833f88a6bf3c95adf412b4eaa32aff5/7b3f4/frontmatter19.png 215w,\n/static/6833f88a6bf3c95adf412b4eaa32aff5/41f14/frontmatter19.png 430w","sizes":"(min-width: 430px) 430px, 100vw"},"sources":[{"srcSet":"/static/6833f88a6bf3c95adf412b4eaa32aff5/3f649/frontmatter19.webp 108w,\n/static/6833f88a6bf3c95adf412b4eaa32aff5/5935f/frontmatter19.webp 215w,\n/static/6833f88a6bf3c95adf412b4eaa32aff5/7da48/frontmatter19.webp 430w","type":"image/webp","sizes":"(min-width: 430px) 430px, 100vw"}]},"width":800,"height":424.18604651162786}}},"tags":["SQL"],"date":"Oct 05, 2016"}}},{"post":{"html":"<p>Having been blessed with an en-dash (alt + 2013) in our TFS project root, I’ve been having lots of fun getting SAS to ‘play nicely’ with non-ascii characters when running OS commands (eg tf.exe).<br /><br />Storing the values in macro variables works fine for direct use (eg in an X command), but running a SAS generated .bat file was proving challenging - until I realised that the issue was actually within the windows shell, rather than SAS itself.<br /><br />The solution turned out to be twofold.  Firstly, the batch file itself needed to be UTF-8 encoded WITHOUT the BOM marker.  This required the <span style=\"background-color: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span>  system <a href=\"https://support.sas.com/documentation/cdl/en/nlsref/61893/HTML/default/viewer.htm#a003105792.htm\" target=\"_blank\">option</a> to be in place before creating the file.<br /><br />Secondly, the shell needs to be configured to read UTF-8 characters.  This can be done by changing the codepage (using  <span style=\"background-color: #eff0f1; color: #242729; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif; font-size: 13px; white-space: inherit;\">chcp 65001</span>) and <a href=\"/chaining-windows-commands-in-sas-filename-pipe/\" target=\"_blank\">chaining</a> with an ampersand.<br /><br />Sample code as follows:<br /><blockquote style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> work=</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%sysfunc</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">(pathname(work));<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> file=&#x26;work/mybatchfile.bat;</span></blockquote>         <b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">file</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“&#x26;file”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">encoding</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘utf-8’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“dir \"\"&#x26;work\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘echo Nonstandard – Dash’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">run</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">    filename</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“chcp 65001 &#x26; \"\"&#x26;file\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">data</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><br /><div></div><br /></p>","frontmatter":{"title":"Reading UTF-8 in Filename Pipe","path":"/reading-utf-8-in-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Sep 06, 2016"}}},{"post":{"html":"<p>Using <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">filename pip</span>e (instead of the <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">X</span> command, or <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">call execute</span>) is a great way to submit OS commands, not least because the standard output can be read directly into SAS.<br /><br />But how does one submit multiple commands in the same filename (or file) statement?<br /><br />Easy - &#x26; I’ll show you how:<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> <span style=\"color: purple;\">“D: &#x26; cd \"\"%sysfunc(pathname(work))\"\" &#x26; dir” </span></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><br />The above snippet opens a shell (via the pipe fileref), changes the working directory to the D drive, then to the work folder (our work location is on a different drive), then executed the dir command to demonstrate that we are indeed in the work folder.<br /><br />The delimiter is, of course, the ampersand (&#x26;).</p>","frontmatter":{"title":"Chaining Windows Commands in SAS Filename Pipe (&)","path":"/chaining-windows-commands-in-sas-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Aug 09, 2016"}}},{"post":{"html":"<p>Currently working on putting our SAS deployment process into TFS and Release Management - part of which involves creating a ‘build’ in Visual Studio.<br /><br />The below caused a build failure, and didn’t come up in google:<br /><blockquote><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\"><br /></span><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">Exception Message: The build controller Visual Studio Controller - internal-svr-name does not contain an enabled build agent with name * and no tags. (type SoapException)SoapException Details: &#x3C;soap:Detail xmlns:soap=”<a href=\"https://www.w3.org/2003/05/soap-envelope\">https://www.w3.org/2003/05/soap-envelope</a>” /></span></blockquote><br />The fix was very straightforward (presuming you are using a Default Template).  In Visual Studio, simply open your build definition, in the ‘Process’ section, under ‘5.Advanced’ expand ‘Agent Settings’ and set your Tag comparison operator to ‘MatchAtLeast’ (instead of MatchExactly):<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"/27bddd216c56524ef4829a50eab7038b/Capture_2.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"96\" src=\"/4203ef6493e897672e6bdef7f561f347/Capture_3.png\" width=\"640\"></a></div><br /></p>","frontmatter":{"title":"Visual Studio Build Controller does not contain an enabled build agent with name * and no tags.","path":"/visual-studio-build-controller-does-not-contain-an-enabled-build-agent-with-name-and-no-tags/","previewImg":null,"tags":["SQL"],"date":"Jul 29, 2016"}}},{"post":{"html":"<p>Converting a SAS date or datetime to javascript isn’t hard, but still - it should be easy to google for!</p>\n<p><span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtSAS=20563;</span>\r\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtJS=new Date(+new Date(1960,0,1) + dtSAS * 86400000);</span>\r\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  alert(dtJS.toUTCString());</span></p>\n<p>Right, that should get rid of 95% of readers, for the rest of you, a quick explanation.</p>\n<p>First, it’s important to note that SAS dates are stored as number of <i>days </i>since Jan 1st, 1960 - whereas Javascript “dates” are actually the number of <i>milliseconds </i>since Jan 1st 1970.  This explains the <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">86400000 </span>value (24 days _ 60 minutes _ 60 seconds * 1000 milliseconds), and why the embedded <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Date() </span>object is set to 1960.</p>\n<p>Next, there’s the ”+” sign before that nested Date object.  That tells Javascript to return a numeric value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">-315619200000</span>) instead of a formatted value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Fri Jan 01 1960 00:00:00 GMT+0000 (GMT Standard Time)</span>).</p>\n<p>Finally, the .toUTCString() method avoids contention with local time conventions (eg the extra 1 hour in BST).</p>\n<p>To make this even easier to deal with, I’ve knocked together a simple Javascript function - see <a href=\"https://jsfiddle.net/rawsas/bzskug3d/\" target=\"_blank\" rel=\"noopener\">fiddle</a>.</p>\n<div style=\"clear: both; text-align: center;\"></div>\r\n<span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// valid in ECMASCRIPT 2016</span>\r\n<span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAS</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// accepts SAS unformatted DATE or DATETIME</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// dtType should be used to determine the above</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// -315619200000 is equivalent to +new Date(1960,0,1)</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// 86400000 is equivalent to 24h * 60m * 60s * 1000ms</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">86400000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    console.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">log</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'Unknown dtType value - '</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtType</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #003366; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">null</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span>\r\n<span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">20578</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1776743820</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<p>If this post was useful, then do also check out <a href=\"/building-web-apps-with-sas\">How To Build Web Apps With SAS</a>.</p>\n<p>And in case you were wondering - datetime <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: x-small;\">1776743820 </span>(GMT) was when Dr Goodnight officially <a href=\"https://www.linkedin.com/hp/update/6128386230842384384\" target=\"_blank\" rel=\"noopener\">announced </a>SAS Viya!</p>","frontmatter":{"title":"Converting SAS date to Javascript datetime (in Javascript)","path":"/converting-sas-date-to-javascript-date-in-javascript/","previewImg":null,"tags":["SQL"],"date":"May 04, 2016"}}},{"post":{"html":"<p>Thought I’d write this one up as the exact error message didn’t appear on google.  Of course, the sharp eyed among you will quickly spot the missing security / authorisation info..<br /><br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15         LIBNAME myLib OLEDB PROPERTIES=(‘initial catalog’=MyCat) DATASOURCE=‘MySvr’ PROVIDER=SQLNCLIxx.x SCHEMA=dbo</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15       ! connection=shared;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error trying to establish connection: Unable to Initialize: Invalid authorization specification</span></div><br /><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error in the LIBNAME statement.</span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background-color: white;\">The fix was to provide a valid connection string, eg as follows (in this particular case):</span></div><div><span style=\"background-color: white;\"><br /></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">LIBNAME</span><span style=\"background: white; font-family: 'Courier New';\"> myLib </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">OLEDB</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROPERTIES</span><span style=\"background: white; font-family: 'Courier New';\">=(</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Integrated Security’</span><span style=\"background: white; font-family: 'Courier New';\">=SSPI </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Persist Security Info’</span><span style=\"background: white; font-family: 'Courier New';\">=True </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘initial catalog’</span><span style=\"background: white; font-family: 'Courier New';\">=MyCat) </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">DATASOURCE</span><span style=\"background: white; font-family: 'Courier New';\">=</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘MySrv’</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROVIDER</span><span style=\"background: white; font-family: 'Courier New';\">=SQLNCLIxx.x  </span></div><div> </div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">SCHEMA</span><span style=\"background: white; font-family: 'Courier New';\">=dbo </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">connection</span><span style=\"background: white; font-family: 'Courier New';\">=shared;</span></div><div><span style=\"background-color: white;\"><br /></span></div><div><span style=\"background-color: white;\">Given that this libname statement was being built <a href=\"https://github.com/sashub/macro/blob/master/standalone/assign_direct_lib.sas\" target=\"_blank\">dynamically</a> from metadata, it was necessary to stick those properties into the server definition, as follows:</span></div><div></div><ol><li>Open SMC</li><li>Expand Server Manager</li><li>Expand the relevant Server (as specified in the Library definition)</li><li>In the properties of the underlying Connection, select the Options tab</li><li>Select OLE DB Connection Information Options</li><li>Stick in the relevant properties as per the libname statement, <i>including brackets</i>.</li></ol></p>","frontmatter":{"title":"Error trying to establish connection: Unable to Initialize: Invalid authorization specification","path":"/error-trying-to-establish-connection-unable-to-initialize-invalid-authorization-specification/","previewImg":null,"tags":["SQL"],"date":"Jan 23, 2016"}}},{"post":{"html":"<p>Occasionally when debugging it can be useful to run as a system account for checking permissions etc.<br /><br />A useful utility for this (in windows) is the “runas” command.  For instance (from the command window):<br /><br /><span style=\"font-family: Courier New, Courier, monospace;\">runas /user:“YourDomainsassrv” “C:Program FilesSASEnterpriseGuide4.3SEGuide.exe”</span><br /><br />or<br /><span style=\"font-family: Courier New, Courier, monospace;\"><br /></span><span style=\"font-family: Courier New, Courier, monospace;\">runas /user:”</span><span style=\"font-family: 'Courier New', Courier, monospace;\">YourDomain</span><span style=\"font-family: Courier New, Courier, monospace;\">sassrv” “C:Program Files (x86)Microsoft SQL Server120ToolsBinnManagementStudioSsms.exe”</span><br /><br />You will be prompted for the password before the client tool opens on your machine.<br /><br /><i>This post was inspired by the fact that one should not log into the application server as sassrv, to avoid conflicting / hung sessions in the STP server, but I can’t find the SAS note to back this up!  However those hung sessions were confirmed real.. </i> <b>Don’t log into sasapp as sassrv.</b></p>","frontmatter":{"title":"Running EG or other client tools as SASSRV","path":"/running-eg-or-other-client-tools-as-sassrv/","previewImg":null,"tags":["SQL"],"date":"Dec 18, 2015"}}},{"post":{"html":"<p>This one had me puzzled for a bit (SAS 9.2, Windows 2008, SQLNCLI10.1, OLEDB):<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;;\">WARNING: The current setting of the DIRECT_EXE libname option will not allow this SQL statement to be passed directly to the DBMS for processing.</span></div><br />Explicitly setting the DIRECT_EXE option to DELETE had no effect.  Assigning the library in a new session, and performing the update also worked fine.  Thankfully the SYSCC variable was not affected, so jobs / processes continued to run, but still…<br /><br />Anyways, it turned out this was actually caused by the SASTRACE option!  Turning this OFF removed the warning.</p>","frontmatter":{"title":"DIRECT_EXE warning","path":"/direct_exe-warning/","previewImg":null,"tags":["SQL"],"date":"Oct 13, 2015"}}},{"post":{"html":"<p>Having seemingly brought down our 9.2 Windows 2008 STP server (only in DEV!!) during development of a yet another (awesome) STP web app, it occurred to me that more information was needed about just how many requests were being batted over.</p>\n<hr />\n<div style=\"color: red; font-family: 'trebuchet ms', arial, 'arial unicode ms', sans-serif; font-weight: bold;\">Stored Process Error</div><div style=\"font-family: 'trebuchet ms', arial, 'arial unicode ms', sans-serif; font-size: small;\">\n<h2 style=\"font-size: medium;\">Unable to execute stored process.</h2>\n<h2 style=\"font-size: medium;\">The server is not running (paused/deferred stop mode?).</h2></div>\n<hr />\nSo, inspired by Quentin McMullen's <a href=\"https://bi-notes.com/2014/02/sas_stored_process_log/\">excellent post</a>, I wanted to share my approach.\n<p><strong>Step 1</strong> was to create a table to log the events. This was structured as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token punctuation\">[</span>dbo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>STP_LOGGER<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>\n <span class=\"token punctuation\">[</span>PROCESSED_DTTM<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>datetime2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>STATUS_CD<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_PROGRAM<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_METAPERSON<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>SYSJOBID<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_SESSIONID<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>GLOB_VARS<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span></code></pre></div>\n<p>Note that this table was not a SAS table (which could be subject to locking). If you have no other choice but to use a SAS table, please refer to the previous post for attempting SAS locks (noting that this <a href=\"/get-physical-path-from-metadata-libref\">cannot be done via the meta engine</a>).</p>\n<p><strong>Step 2</strong> was to create a <a href=\"https://github.com/sashub/macro/blob/master/standalone/stp_logger.sas\">macro</a> to update the table (to be placed somewhere in <a href=\"https://support.sas.com/documentation/cdl/en/hostwin/63285/HTML/default/viewer.htm#win-sysop-sasautos.htm\">SASAUTOS</a>). Example below:</p>\n<div class=\"gatsby-highlight\" data-language=\"sas\"><pre class=\"language-sas\"><code class=\"language-sas\"><span class=\"token macro-declaration\"><span class=\"token keyword\">%macro</span> stp_logger(status_cd=)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%local</span> global_vars<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">proc sql</span> noprint<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">select</span> <span class=\"token function keyword\">cats</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token string\">'='</span><span class=\"token punctuation\">,</span>value<span class=\"token punctuation\">)</span>\n    into: global_vars\n    separated <span class=\"token keyword\">by</span> <span class=\"token string\">'|'</span>\n    from dictionary<span class=\"token punctuation\">.</span>macros\n    <span class=\"token keyword\">where</span> scope <span class=\"token operator\">=</span> <span class=\"token string\">'GLOBAL'</span>\n    <span class=\"token keyword\">and</span> <span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator-keyword operator\">not</span> <span class=\"token function keyword\">in</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SQL'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SAS'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">and</span> <span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator-keyword operator\">ne</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function keyword\">%assign_lib</span><span class=\"token punctuation\">(</span>libref<span class=\"token operator\">=</span>web<span class=\"token punctuation\">)</span>\n\n  <span class=\"token step keyword\">proc datasets</span> library<span class=\"token operator\">=</span>work<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">delete</span> append<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">run</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">data</span> append <span class=\"token operator\">/</span>view<span class=\"token operator\">=</span>append<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token number\">0</span> <span class=\"token keyword\">then</span> <span class=\"token keyword\">set</span> web<span class=\"token punctuation\">.</span>stp_logger<span class=\"token punctuation\">;</span>\n    PROCESSED_DTTM<span class=\"token operator\">=</span><span class=\"token macro-keyword keyword\">%sysfunc</span><span class=\"token punctuation\">(</span><span class=\"token function keyword\">datetime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    STATUS_CD<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;status_cd\"</span><span class=\"token punctuation\">;</span>\n    _PROGRAM<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;_program\"</span><span class=\"token punctuation\">;</span>\n    _METAPERSON<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;_metaperson\"</span><span class=\"token punctuation\">;</span>\n    SYSJOBID<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;sysjobid\"</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n  <span class=\"token macro-keyword keyword\">%if</span> <span class=\"token operator-keyword operator\">not</span> <span class=\"token macro-keyword keyword\">%symexist</span><span class=\"token punctuation\">(</span>_SESSIONID<span class=\"token punctuation\">)</span> <span class=\"token macro-keyword keyword\">%then</span> <span class=\"token macro-keyword keyword\">%do</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* session id is stored in the replay variable but needs to be extracted */</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_replay'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">subpad</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token function keyword\">index</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token string\">'_sessionid='</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token function keyword\">length</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    index<span class=\"token operator\">=</span><span class=\"token function keyword\">index</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token string\">'&amp;'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> index<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">then</span> index<span class=\"token operator\">=</span><span class=\"token function keyword\">length</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _SESSIONID<span class=\"token operator\">=</span>_replay<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">drop</span> _replay index<span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%end</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%else</span> <span class=\"token macro-keyword keyword\">%do</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* explicitly created sessions are automatically available */</span>\n    _SESSIONID<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_SESSIONID'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%end</span><span class=\"token punctuation\">;</span>\n    GLOB_VARS<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'global_vars'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">output</span><span class=\"token punctuation\">;</span>\n    stop<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">run</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">proc append</span> base<span class=\"token operator\">=</span>web<span class=\"token punctuation\">.</span>stp_logger <span class=\"token keyword\">data</span><span class=\"token operator\">=</span>append<span class=\"token punctuation\">;</span>run<span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">proc sql</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">drop</span> view append<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro-end\"><span class=\"token keyword\">%mend</span> stp_logger</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><b>Step 3</b> was to call the macro.   The quick / dirty way would be to simply include it in the SAS programs directly, but that quickly becomes unmanageable when dealing with a large number of STPs.  Another option is to include in the autoexec, but that will only deal with program ENTRY (not exit).\nThe best approach, as endorsed by <a href=\"https://bi-notes.com/2014/02/sas_stored_process_log/#comment-1955\">Don Henderson</a>, is to use the STP init and term programs.  These are straightforward .sas programs that run on an STP session’s entry and exit.  Configuration is simple, and explained here:  <a href=\"https://support.sas.com/kb/39/250.html\"><a href=\"https://support.sas.com/kb/39/250.html\">https://support.sas.com/kb/39/250.html</a></a>.</p>\n<p>This approach is fantastic as it will ensure that ALL calls to the STP server are logged (eg via EG, AMO, WRS, every custom web app, etc etc).   Simply add the following one-liners to each file:</p>\n<div class=\"gatsby-highlight\" data-language=\"sas\"><pre class=\"language-sas\"><code class=\"language-sas\"><span class=\"token function keyword\">%stp_logger</span><span class=\"token punctuation\">(</span>status_cd<span class=\"token operator\">=</span>SrvEnter<span class=\"token punctuation\">)</span>  <span class=\"token comment\">/* goes in the init file */</span>\n<span class=\"token function keyword\">%stp_logger</span><span class=\"token punctuation\">(</span>status_cd<span class=\"token operator\">=</span>SrvExit<span class=\"token punctuation\">)</span>   <span class=\"token comment\">/* goes in the term file */</span></code></pre></div>\n<p>Boom, we are done, and here is an extract of the new logging table:</p>\n<p><img src=\"/45e987897554f08dfd95c1478cca7024/Capture_4.png\" alt=\"\"></p>\n<p>See that highlighted row?  A hung session with my name against it…</p>\n<p><img src=\"https://1.bp.blogspot.com/-iq3rv-RygCQ/VenmQacknMI/AAAAAAAAAlw/uz0v7PUwxQU/s320/2010-02-24-hangman.jpg\" alt=\"\"></p>\n<p><strong>EDIT 13OCT2015:</strong>\n<em>The connection issue was finally resolved by setting the <a href=\"https://support.sas.com/rnd/itech/doc9/admin_oma/sasserver/iombridge/sp_sercl.html#sasRecycleActivationLimit\">Recycle Activation Limit</a> to 1.  This had no noticeable effect on performance.</em></p>","frontmatter":{"title":"Event Logging of Stored Process Server Sessions","path":"/event-logging-of-stored-process-server-sessions/","previewImg":null,"tags":["SQL"],"date":"Sep 04, 2015"}}}]}},"pageContext":{"page":"category","archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3},"filter":{"frontmatter":{"tags":{"in":["SQL"]}}},"limit":10,"skip":10,"numPages":4,"currentPage":2,"tag":"SQL"}},"staticQueryHashes":["1133634862"],"slicesMap":{}}