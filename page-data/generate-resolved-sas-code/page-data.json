{"componentChunkName":"component---src-templates-template-tsx","path":"/generate-resolved-sas-code/","result":{"data":{"post":{"id":"770e2587-b9af-5640-b6e6-5e8102aa069f","html":"<p>Got a complex macro?  Don’t have time to work out what it is actually doing?  Its much easier to work with resolved code!  The macro below will help - just stick it at the start of your code, and write the resolved code somewhere else (which can then be ‘stepped through’ to understand whats going on).<br /><br /><br /><br /><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%macro</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\"><b><i>x</i></b>;  </span><span style=\"background: white; color: green; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">/_ mfile will only work if its inside a macro! <em>/</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%let</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">loc=c:tempMyResolvedCode.txt; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%let</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">rc = </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%sysfunc</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">(filename(fref,&#x26;loc)); </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%let</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">rc = </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">%sysfunc</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">(fdelete(&#x26;fref));  </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      filename mprint </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">“&#x26;loc”</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">lrecl=</span><b><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">2048</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      options mfile mprint ;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      data <em>null</em>;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      if <em>n</em>=</span><b><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">1</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">then call execute(</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">“Data <em>null</em>;”</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">);</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      set sashelp.vlibnam(where=(substr(libname,</span><b><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">1</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">,</span><b><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">3</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">) ne </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">‘SAS’</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">));</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      if cats(libname,path) ne unique then </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">        call execute(</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">‘comment Find&#x26;ReplaceMe libname ’</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">||libname||</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">’ “’</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">||trim(path)||</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">’”;’</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">); </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      retain unique;  unique=cats(libname,path);</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\">      run;run; </span><span style=\"background: white; color: green; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">/</em> this bit retrieves the relevant libraries, without executing anything.. _/</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt;\"></span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 115%;\">%mend</span></b><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt; line-height: 115%;\">;  %<b><i>x</i></b></span></div><br /><br />Points to note:<br /><br /><ul><li>If your macro is data driven, the code above may change depending on the data!</li><li>The delete function does not  always work (eg if your SAS session still has the file open)</li><li>The comment feature is very old!  Credit to James Taylor for knowing about this.</li><li>You may find for practical use, all you really need is this:</li></ul><div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; color: blue; font-family: 'Courier New'; font-size: 10pt;\">filename</span><span style=\"background-color: white; font-family: 'Courier New'; font-size: 10pt;\">mprint </span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; color: purple; font-family: 'Courier New'; font-size: 10pt;\">“c:tempMyResolvedCode.txt”</span><span style=\"background-color: white; font-family: 'Courier New'; font-size: 10pt;\"></span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; color: blue; font-family: 'Courier New'; font-size: 10pt;\">lrecl</span><span style=\"background-color: white; font-family: 'Courier New'; font-size: 10pt;\">=</span><b><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;; font-size: 10.0pt;\">2048</span></b><span style=\"background-color: white; font-family: 'Courier New'; font-size: 10pt;\">;</span></div><div><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 115%;\">options</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt; line-height: 115%;\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 115%;\">mfile</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt; line-height: 115%;\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;; font-size: 10.0pt; line-height: 115%;\">mprint</span><span style=\"background-color: white; background-position: initial initial; background-repeat: initial initial; font-family: 'Courier New'; font-size: 10pt; line-height: 115%;\"> ;</span></div></div><div><br /></div><br /></p>","frontmatter":{"title":"Generate Resolved SAS code","path":"/generate-resolved-sas-code/","previewImg":null,"tags":["SQL"],"date":"Nov 15, 2012"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3}}},"staticQueryHashes":["1133634862"],"slicesMap":{}}