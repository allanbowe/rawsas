{"componentChunkName":"component---src-templates-template-tsx","path":"/invoking-stored-processes-with-powershell-the-easy-way/","result":{"data":{"post":{"id":"7d7d419b-4293-5e7b-a528-0c2c0d58e788","html":"<p>There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href=\"https://blogs.sas.com/content/sasdummy/tag/powershell/\" target=\"_blank\">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just <b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I’m going to split the example over three lines:</div><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$uri</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">”<a href=\"https://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do%22\">https://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do”</a></span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$pgm</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">“/Products/SAS Intelligence Platform/Samples/Sample: Hello World”</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">invoke-webrequest</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"> <span style=\"color: navy;\">-Uri</span> <span style=\"color: darkred;\">”</span>$(<span style=\"color: orangered;\">$uri</span>)<span style=\"color: darkred;\">?_program=</span><span style=\"color: orangered;\">$pgm</span><span style=\"color: darkred;\">”</span> <span style=\"color: navy;\">-UseDefaultCredentials</span></span></div></blockquote>\nWhich gives the response:<br /><br /></p>\n<div style=\"clear: both; text-align: center;\">\n<a href=\"./images/psresponse.png\" style=\"margin-left: 1em; margin-right: 1em;\"></div>\n<br />The key part to this request, to avoid HTTP Status 401 and \"This request requires HTTP authentication\" response, is the&nbsp;<span style=\"background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;\">-UseDefaultCredentials&nbsp;</span>parameter. &nbsp;This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output&nbsp;</li><li>You may need to set your execution policy (explained <a href=\"https://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/\" target=\"_blank\">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul>","frontmatter":{"title":"Invoking Stored Processes with Powershell - the easy way","path":"/invoking-stored-processes-with-powershell-the-easy-way/","previewImg":null,"tags":["Powershell"],"date":"Aug 31, 2016"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3}}},"staticQueryHashes":["1133634862"],"slicesMap":{}}