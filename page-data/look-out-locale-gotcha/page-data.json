{"componentChunkName":"component---src-templates-template-tsx","path":"/look-out-locale-gotcha/","result":{"data":{"post":{"id":"38b816ec-78c2-5516-b1eb-1ff57e45f930","html":"<p>As gotcha’s go, this was a good one!</p>\n<p>We had a report being generated with dates that were inconsistent with the source file (MMDDYY instead of DDMMYY), but only for certain records.  This was definitely related to the <span style=\"font-family: 'courier new' , 'courier' , monospace;\">ANYDTDTE</span>. informat, but the strange thing was - this issue only occurred when the report was generated by the Stored Process Server (it was fine in batch).</p>\n<p>The <span style=\"font-family: 'courier new' , 'courier' , monospace;\">ANYDTDTE</span>. informat is driven by the locale setting but as per the chain of sasv9.cfg files we had <span style=\"font-family: Courier New, Courier, monospace;\">-LOCALE en_GB</span><span style=\"font-family: courier new, courier, monospace;\"> </span><span style=\"font-family: inherit;\">defined for</span> both servers.  So I checked the logs, and found something interesting..</p>\n<p>One of our STP applications can be triggered from either Excel or a browser.  I could see that the same user had triggered two requests, less than a minute apart, one from excel and one from a browser (as evidenced by the value of the _HTUA variable)</p>\n<p>Yet one session had <span style=\"font-family: 'courier new' , 'courier' , monospace;\">_USERLOCALE=en_US</span> and the other had <span style=\"font-family: 'courier new' , 'courier' , monospace;\">_USERLOCALE=en_GB</span>!!</p>\n<p>As it turns out, the locale for a Stored Process session <i>can change according to the context of the client</i> - as described in this <a href=\"https://support.sas.com/kb/45/414.html\" target=\"_blank\" rel=\"noopener\">usage note</a>.</p>\n<p>So the fix is simply to add the following code (as per your desired locale):</p>\n<blockquote><span style=\"font-family: 'courier new' , 'courier' , monospace;\">options locale=en_gb;</span></blockquote>\r\nBut where?\n<p>I tried fixing this via the autoexec, but this had no effect (likely because the server is running before the request arrives) so instead I added it to the stp init program - which worked a treat.\r\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.595744680851062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGUlEQVR42i2Qy3KCMABF+f+P6XTZdTc+qqBVEQlJ5E3lDeL2NNAuzuQmd+bM3FiuUlyV5hJIzkKaU+HdIy5Sc55znHFLcmTxIGo6iuFJMU78PF9/zNkwv2emtzw/QGtNVVVEYYTwfbSSBoWSEikEWgYI72r6kH4c6dqWumpom4bB5IWupTN3K80y0jRdmMUb+8TGubA9eqwPHivnyvqk2Hopu9WO9fsbvi8YhoG8rAni/J+CrGqxMiOM44QkmYV3tgeX/feN3dGIbNfIXU5+iIhL0ycctns2X3te05OoqHBUxtFgBykyr40wzynLcpkcRhG+UARmpute0cENWzz4cCc+vY5xmkjMX+5sh6Hvaep6mTr2Hc+hX/Ivq9xrZ5og9fUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 300x79\" title=\"\" src=\"/static/30f4d55f64791cc5630df4113fca45a1/5a46d/Capture-300x79.png\" srcset=\"/static/30f4d55f64791cc5630df4113fca45a1/4dcb9/Capture-300x79.png 188w,\n/static/30f4d55f64791cc5630df4113fca45a1/5a46d/Capture-300x79.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\r\n<b>I recommend adding this to your init program</b>, unless you really do want your outputs to change according to the locale setting of the client application!</p>\n<div style=\"clear: both; text-align: center;\"></div>","frontmatter":{"title":"Look out - Locale Gotcha","path":"/look-out-locale-gotcha/","previewImg":{"publicURL":"/static/e4e610369faede071a7330a17d396eb6/frontmatter16.png","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/e4e610369faede071a7330a17d396eb6/eec87/frontmatter16.png","srcSet":"/static/e4e610369faede071a7330a17d396eb6/7d5fc/frontmatter16.png 177w,\n/static/e4e610369faede071a7330a17d396eb6/5ab00/frontmatter16.png 355w,\n/static/e4e610369faede071a7330a17d396eb6/eec87/frontmatter16.png 709w","sizes":"(min-width: 709px) 709px, 100vw"},"sources":[{"srcSet":"/static/e4e610369faede071a7330a17d396eb6/29ce6/frontmatter16.webp 177w,\n/static/e4e610369faede071a7330a17d396eb6/dc4e2/frontmatter16.webp 355w,\n/static/e4e610369faede071a7330a17d396eb6/98f2c/frontmatter16.webp 709w","type":"image/webp","sizes":"(min-width: 709px) 709px, 100vw"}]},"width":800,"height":211.00141043723553}}},"tags":["sas","SAS Stored Process Web Application","Stored Process Web Applications","Web Applications"],"date":"Dec 12, 2016"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3}}},"staticQueryHashes":["1133634862"],"slicesMap":{}}