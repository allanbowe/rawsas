{"componentChunkName":"component---src-templates-post-list-template-tsx","path":"/page/6/","result":{"data":{"remark":{"posts":[{"post":{"html":"<p>There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href=\"https://blogs.sas.com/content/sasdummy/tag/powershell/\" target=\"_blank\">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just <b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I’m going to split the example over three lines:</div><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$uri</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">”<a href=\"https://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do%22\">https://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do”</a></span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$pgm</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">“/Products/SAS Intelligence Platform/Samples/Sample: Hello World”</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">invoke-webrequest</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"> <span style=\"color: navy;\">-Uri</span> <span style=\"color: darkred;\">”</span>$(<span style=\"color: orangered;\">$uri</span>)<span style=\"color: darkred;\">?_program=</span><span style=\"color: orangered;\">$pgm</span><span style=\"color: darkred;\">”</span> <span style=\"color: navy;\">-UseDefaultCredentials</span></span></div></blockquote>\nWhich gives the response:<br /><br /></p>\n<div style=\"clear: both; text-align: center;\">\n<a href=\"./images/psresponse.png\" style=\"margin-left: 1em; margin-right: 1em;\"></div>\n<br />The key part to this request, to avoid HTTP Status 401 and \"This request requires HTTP authentication\" response, is the&nbsp;<span style=\"background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;\">-UseDefaultCredentials&nbsp;</span>parameter. &nbsp;This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output&nbsp;</li><li>You may need to set your execution policy (explained <a href=\"https://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/\" target=\"_blank\">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul>","frontmatter":{"title":"Invoking Stored Processes with Powershell - the easy way","path":"/invoking-stored-processes-with-powershell-the-easy-way/","previewImg":null,"tags":["Powershell"],"date":"Aug 31, 2016"}}},{"post":{"html":"<p>Using <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">filename pip</span>e (instead of the <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">X</span> command, or <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">call execute</span>) is a great way to submit OS commands, not least because the standard output can be read directly into SAS.<br /><br />But how does one submit multiple commands in the same filename (or file) statement?<br /><br />Easy - &#x26; I’ll show you how:<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> <span style=\"color: purple;\">“D: &#x26; cd \"\"%sysfunc(pathname(work))\"\" &#x26; dir” </span></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><br />The above snippet opens a shell (via the pipe fileref), changes the working directory to the D drive, then to the work folder (our work location is on a different drive), then executed the dir command to demonstrate that we are indeed in the work folder.<br /><br />The delimiter is, of course, the ampersand (&#x26;).</p>","frontmatter":{"title":"Chaining Windows Commands in SAS Filename Pipe (&)","path":"/chaining-windows-commands-in-sas-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Aug 09, 2016"}}},{"post":{"html":"<p>Currently working on putting our SAS deployment process into TFS and Release Management - part of which involves creating a ‘build’ in Visual Studio.<br /><br />The below caused a build failure, and didn’t come up in google:<br /><blockquote><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\"><br /></span><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">Exception Message: The build controller Visual Studio Controller - internal-svr-name does not contain an enabled build agent with name * and no tags. (type SoapException)SoapException Details: &#x3C;soap:Detail xmlns:soap=”<a href=\"https://www.w3.org/2003/05/soap-envelope\">https://www.w3.org/2003/05/soap-envelope</a>” /></span></blockquote><br />The fix was very straightforward (presuming you are using a Default Template).  In Visual Studio, simply open your build definition, in the ‘Process’ section, under ‘5.Advanced’ expand ‘Agent Settings’ and set your Tag comparison operator to ‘MatchAtLeast’ (instead of MatchExactly):<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"/27bddd216c56524ef4829a50eab7038b/Capture_2.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"96\" src=\"/4203ef6493e897672e6bdef7f561f347/Capture_3.png\" width=\"640\"></a></div><br /></p>","frontmatter":{"title":"Visual Studio Build Controller does not contain an enabled build agent with name * and no tags.","path":"/visual-studio-build-controller-does-not-contain-an-enabled-build-agent-with-name-and-no-tags/","previewImg":null,"tags":["SQL"],"date":"Jul 29, 2016"}}},{"post":{"html":"<p>Having a list of domain users and associated properties can be useful for a number of reasons:<br /><br /><ul><li>Identifying joiners / leavers</li><li>Getting a list of employees</li><li>Converting usernames into email addresses</li><li>Alerting administrators when accounts are locked out</li></ul><div>Below is an approach for obtaining those users, producing a SAS dataset that could serve in a DI job for staging a database table.</div><div><blockquote style=\"margin-bottom: 0.0001pt;\"><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/_ set up command via pipe fileref _/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">noquotelenmax</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">filename</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> process </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“powershell \"\"Get-ADUser -Filter {enabled -eq $True} -properties Title,LockedOut,Created,Department,EmailAddress</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">  |Select-Object SamAccountName,Name,GivenName,Surname,UserPrincipalName,DistinguishedName,Title,LockedOut,created,Department,EmailAddress</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">  |Export-CSV  ‘%sysfunc(pathname(work))ad_users.csv’ \"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><br /></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/* execute command and capture any output from the shell <em>/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> process; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <span style=\"color: blue;\">list</span></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><br /></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/</em> load CSV into SAS dataset */</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> AD_USERS;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“%sysfunc(pathname(work))ad_users.csv”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">dsd</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">firstobs</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">3</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">lrecl</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">10000</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> SamAccountName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> name:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> GivenName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    SurName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> UserPrincipalName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$200.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    DistinguishedName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$500.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> Title:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> LockedOut:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$5.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    created:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$25.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> Department:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EmailAddress:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">if</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> index(DistinguishedName,</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘OU=Employees’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">then</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EMPLOYEE_FLG=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">1</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">else</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EMPLOYEE_FLG=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">0</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div></blockquote><div></div></div><div><br /></div><div>This will extract all ACTIVE accounts (enabled eq $True) with some selected additional properties (more <a href=\"http://social.technet.microsoft.com/wiki/contents/articles/12037.active-directory-get-aduser-default-and-extended-properties.aspx\" target=\"_blank\">here</a>).  Some conditional logic is applied to distinguish employees from service accounts.</div><div><br /><div>Prerequisites:</div><div><ul><li>X Command enabled (see <a href=\"https://support.sas.com/kb/15/179.html\" target=\"_blank\">here </a>for instructions, is similar process for workspace servers)</li><li>Powershell installed</li></ul></div></div><div>Enjoy!</div><div><br /></div><div><br /></div></p>","frontmatter":{"title":"Extracting Active Directory accounts into SAS using Powershell","path":"/extracting-active-directory-accounts-into-sas-using-powershell/","previewImg":null,"tags":["sas powershell ad-users windows domain accounts"],"date":"Jun 22, 2016"}}},{"post":{"html":"<p>Converting a SAS date or datetime to javascript isn’t hard, but still - it should be easy to google for!</p>\n<p><span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtSAS=20563;</span>\r\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtJS=new Date(+new Date(1960,0,1) + dtSAS * 86400000);</span>\r\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  alert(dtJS.toUTCString());</span></p>\n<p>Right, that should get rid of 95% of readers, for the rest of you, a quick explanation.</p>\n<p>First, it’s important to note that SAS dates are stored as number of <i>days </i>since Jan 1st, 1960 - whereas Javascript “dates” are actually the number of <i>milliseconds </i>since Jan 1st 1970.  This explains the <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">86400000 </span>value (24 days _ 60 minutes _ 60 seconds * 1000 milliseconds), and why the embedded <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Date() </span>object is set to 1960.</p>\n<p>Next, there’s the ”+” sign before that nested Date object.  That tells Javascript to return a numeric value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">-315619200000</span>) instead of a formatted value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Fri Jan 01 1960 00:00:00 GMT+0000 (GMT Standard Time)</span>).</p>\n<p>Finally, the .toUTCString() method avoids contention with local time conventions (eg the extra 1 hour in BST).</p>\n<p>To make this even easier to deal with, I’ve knocked together a simple Javascript function - see <a href=\"https://jsfiddle.net/rawsas/bzskug3d/\" target=\"_blank\" rel=\"noopener\">fiddle</a>.</p>\n<div style=\"clear: both; text-align: center;\"></div>\r\n<span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// valid in ECMASCRIPT 2016</span>\r\n<span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAS</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// accepts SAS unformatted DATE or DATETIME</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// dtType should be used to determine the above</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// -315619200000 is equivalent to +new Date(1960,0,1)</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// 86400000 is equivalent to 24h * 60m * 60s * 1000ms</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">86400000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    console.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">log</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'Unknown dtType value - '</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtType</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #003366; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">null</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span>\r\n<span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">20578</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\r\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1776743820</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<p>If this post was useful, then do also check out <a href=\"/building-web-apps-with-sas\">How To Build Web Apps With SAS</a>.</p>\n<p>And in case you were wondering - datetime <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: x-small;\">1776743820 </span>(GMT) was when Dr Goodnight officially <a href=\"https://www.linkedin.com/hp/update/6128386230842384384\" target=\"_blank\" rel=\"noopener\">announced </a>SAS Viya!</p>","frontmatter":{"title":"Converting SAS date to Javascript datetime (in Javascript)","path":"/converting-sas-date-to-javascript-date-in-javascript/","previewImg":null,"tags":["SQL"],"date":"May 04, 2016"}}},{"post":{"html":"<p>Thought I’d write this one up as the exact error message didn’t appear on google.  Of course, the sharp eyed among you will quickly spot the missing security / authorisation info..<br /><br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15         LIBNAME myLib OLEDB PROPERTIES=(‘initial catalog’=MyCat) DATASOURCE=‘MySvr’ PROVIDER=SQLNCLIxx.x SCHEMA=dbo</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15       ! connection=shared;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error trying to establish connection: Unable to Initialize: Invalid authorization specification</span></div><br /><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error in the LIBNAME statement.</span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background-color: white;\">The fix was to provide a valid connection string, eg as follows (in this particular case):</span></div><div><span style=\"background-color: white;\"><br /></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">LIBNAME</span><span style=\"background: white; font-family: 'Courier New';\"> myLib </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">OLEDB</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROPERTIES</span><span style=\"background: white; font-family: 'Courier New';\">=(</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Integrated Security’</span><span style=\"background: white; font-family: 'Courier New';\">=SSPI </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Persist Security Info’</span><span style=\"background: white; font-family: 'Courier New';\">=True </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘initial catalog’</span><span style=\"background: white; font-family: 'Courier New';\">=MyCat) </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">DATASOURCE</span><span style=\"background: white; font-family: 'Courier New';\">=</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘MySrv’</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROVIDER</span><span style=\"background: white; font-family: 'Courier New';\">=SQLNCLIxx.x  </span></div><div> </div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">SCHEMA</span><span style=\"background: white; font-family: 'Courier New';\">=dbo </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">connection</span><span style=\"background: white; font-family: 'Courier New';\">=shared;</span></div><div><span style=\"background-color: white;\"><br /></span></div><div><span style=\"background-color: white;\">Given that this libname statement was being built <a href=\"https://github.com/sashub/macro/blob/master/standalone/assign_direct_lib.sas\" target=\"_blank\">dynamically</a> from metadata, it was necessary to stick those properties into the server definition, as follows:</span></div><div></div><ol><li>Open SMC</li><li>Expand Server Manager</li><li>Expand the relevant Server (as specified in the Library definition)</li><li>In the properties of the underlying Connection, select the Options tab</li><li>Select OLE DB Connection Information Options</li><li>Stick in the relevant properties as per the libname statement, <i>including brackets</i>.</li></ol></p>","frontmatter":{"title":"Error trying to establish connection: Unable to Initialize: Invalid authorization specification","path":"/error-trying-to-establish-connection-unable-to-initialize-invalid-authorization-specification/","previewImg":null,"tags":["SQL"],"date":"Jan 23, 2016"}}},{"post":{"html":"<p>Surprisingly little attention is given to the (huge) potential of the SAS platform for building web apps.  On the assumption this is due to sheer ignorance, the aim of this post is to share some of my experience, and give budding SAS web-developers a kick start in the right direction.</p>\n<p>But first, what kind of things can you build?  Well, anything really, by combining HTML / CSS / Javascript and using SAS as a server side language (via the Stored Process Server) you have an immensely powerful / scalable application development capability.</p>\n<p>For instance, to reference some examples of web apps I’ve built over the years:</p>\n<ul>\n \t<li>Drilldown Reports - <i>Click a number, see the numbers &amp; formula used to create that number, all the way back to source system.</i></li>\n \t<li>Build &amp; Test harness - <i>Allowed selection of a development&nbsp;branch from remote GIT repo, checked out all macros / metadata, imported / deployed the jobs, ran entire solution plus tests, scanned logs for warnings / errors, worked for multiple users.</i></li>\n \t<li>Release Management System -<i> To manage the entire workflow from creating a DEV package through peer review, checking in / out of SVN, interfacing via APIs to internal and external systems, moving promotion artefacts between SAS environments, reporting etc.</i></li>\n \t<li>Data Editor - <i>A generic browser based tool for making auditable changes to data, moving the data through an approvals process (showing exact changes to base) with signoff resulting in immediate loading to the target table.</i></li>\n</ul>\n<div>Plus a number of smaller, client specific tools. &nbsp;Am sure you can think of lots of use cases where a small web app would be helpful to your customers.</div>\n<div></div>\n<div>The following is a quick start guide to get you talking to SAS from your favourite browser (which for me is Firefox, it has the best debugging capabilities).</div>\n<div></div>\n<h6><b>Step 1 - Create a folder structure</b></h6>\n<div>This should go in the root of the web server, eg ROOT.war in JBOSS ( eg&nbsp;<span style=\"font-family: Courier New, Courier, monospace;\">Jbossjboss-asserverSASServer1deployjboss-web.deployerROOT.war</span>) on the mid-tier machine, or equivalent for a different web server.</div>\n<div></div>\n<div>You may choose to organise .html, .js, .css &nbsp;files and images etc into separate folders or distinguish by project.. &nbsp;But either way the number of these files will grow so be sure to have a plan to keep things organised. &nbsp;At this point you may wish to ask your admin to create a network share on this directory, so you can push files without having to log into the server.</div>\n<div></div>\n<h6><b>Step 2 - Create your HTML file (example.html)</b></h6>\n<div>Example contents below:</div>\n&nbsp;\n<div><span style=\"color: #00bbdd; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;!DOCTYPE html&gt;</span>\n<span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/html.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">html</span></a>&nbsp;<span style=\"color: #000066;\">lang</span><span style=\"color: #66cc66;\">=</span><span style=\"color: red;\">\"en\"</span>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/head.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">head</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/meta.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">meta</span></a>&nbsp;<span style=\"color: #000066;\">http-equiv</span><span style=\"color: #66cc66;\">=</span><span style=\"color: red;\">\"X-UA-<wbr>Compatible\"</span>&nbsp;<span style=\"color: #000066;\">content</span><span style=\"color: #66cc66;\">=</span><span style=\"color: red;\">\"IE=edge;\"</span><wbr>&nbsp;<span style=\"color: #000066;\">charset</span><span style=\"color: #66cc66;\">=</span><span style=\"color: red;\">\"utf-8\"</span><span style=\"color: #66cc66;\">/</span>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/title.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">title</span></a>&gt;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">SAS Web App#1</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/title.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">title</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">script</span></a>&nbsp;<span style=\"color: #000066;\">src</span><span style=\"color: #66cc66;\">=</span>..<span style=\"color: #66cc66;\">/</span>js<span style=\"color: #66cc66;\">/</span>jquery.js&gt;<wbr>&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">script</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">script</span></a>&nbsp;<span style=\"color: #000066;\">src</span><span style=\"color: #66cc66;\">=</span>..<span style=\"color: #66cc66;\">/</span>js<span style=\"color: #66cc66;\">/</span>h54s.js&gt;&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\"><wbr>script</span></a>&gt;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp; &nbsp;&nbsp;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">script</span></a>&nbsp;<span style=\"color: #000066;\">src</span><span style=\"color: #66cc66;\">=</span>..<span style=\"color: #66cc66;\">/</span>js<span style=\"color: #66cc66;\">/</span>example.<wbr>js&gt;&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/script.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">script</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/head.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">head</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/body.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">body</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/h1.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">h1</span></a>&gt;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;Click submit to see a listing of SAS groups&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/h1.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">h1</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/ul.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">ul</span></a>&nbsp;<span style=\"color: #000066;\">id</span><span style=\"color: #66cc66;\">=</span>SASgroups&gt;&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/ul.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">ul</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<a style=\"color: #000066;\" href=\"https://december.com/html/4/element/button.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">button</span></a>&nbsp;<span style=\"color: #000066;\">id</span><span style=\"color: #66cc66;\">=</span>sasSubmit&gt;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Submit</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\"><wbr>/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/button.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">button</span></a>&gt;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/body.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">body</span></a>&gt;</span>\n<span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&lt;<span style=\"color: #66cc66;\">/</span><a style=\"color: #000066;\" href=\"https://december.com/html/4/element/html.html\" target=\"_blank\" rel=\"noopener\"><span style=\"color: black; font-weight: bold;\">html</span></a>&gt;</span></div>\n<div></div>\n<div>Some things to notice regarding this markup:</div>\n<div>\n<ul>\n \t<li>&lt;!DOCTYPE html&gt; means this is a&nbsp;HTML5&nbsp;document</li>\n \t<li>We are referencing a jQuery library (highly recommended). &nbsp;The source code is <a href=\"https://jquery.com/download/\">here</a>.</li>\n \t<li>We have a dedicated .js file to manage our new app (<span style=\"font-family: Courier New, Courier, monospace;\">example.js</span>)</li>\n \t<li>The document is fairly loosely typed, for brevity (unquoted ids for instance). &nbsp;This is all legal in HTML5.</li>\n \t<li>Syntax highlighting from&nbsp;<a href=\"http://qbnz.com/highlighter/demo.php\">http://qbnz.com/highlighter/demo.php</a></li>\n</ul>\n</div>\n<div></div>\n<h6><b>Step 3 - Create your Javascript file (example.js)</b></h6>\n<div>Example contents below:</div>\n&nbsp;\n<div><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">$</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">document</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">ready</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; $</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"#sasSubmit\"</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">on</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'click'</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">fun<wbr>ction</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;youClicked</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<br style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;youClicked</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; $</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'#SASgroups'</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">empty</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* empty list before repopulating */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">var</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;adapter&nbsp;</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;h54s</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* only need one instance */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">var</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;myParams&nbsp;</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* create empty object */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; myParams.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">VARNAME</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'Variable Value'</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* create a variable &amp; value */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">var</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;jsTablesObject&nbsp;</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;<wbr>h54s.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Tables</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">[</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">myParams</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">]</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'<wbr>SASControlTable'</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* make a H54s dataset */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; adapter.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">call</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'/Webapp/example'</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><wbr>,</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">jsTablesObject</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">err</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">r<wbr>es</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* we just submitted an STP request, now deal with response */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; $.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">each</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">res.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">fromSAS</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #000066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">i</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><wbr>,</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;item</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style=\"color: #006600; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* cycle through each attribute and add to html list */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; &nbsp; $</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'#SASgroups'</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">append</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'&lt;li&gt;'</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><wbr>+</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;item.</span><span style=\"color: #660066; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">GROUPNAME</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #3366cc; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'&lt;/li&gt;'</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"color: #009900; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span></div>\n&nbsp;\n<h6><b>Step 4 - Create your SAS Stored Process (example.sas)</b></h6>\n<div>Two parts - first create the .sas file (example contents below, save in the usual STP location), then register as an STP in Management Console (be sure it has STREAMING output).</div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.765957446808514%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVR42oVRa4+jMAzk//+8Pe0WCAm021KS8KY8Ar3O2a602m8XaWTH4/gxib6tR9e1sNaishXmecHr9cLz+QRefzFsT3y6BWkToNoA3e9i02YTq7odxXggH3Yk9YZIZRpKKQzDiBCCgIu9cSAcBx7bG+MSMC07HuuBORyYth3DvIn/IH9cd0TGaBiTwzqHuqnhnEXbNmLr2gu8d/DEc5zvzFX3Euu6gg9vxOATcWJd12i7jtDSYy+re3noxGc5GM574Tm3oeLDMGCaJsE4jiRdjyhJYmhjUFWVFCjLEh9/PqAyha/TF+GEOI7FMkyeUzPe5N1QGjkvQzEXFUWOnByTG2Q6Q3m/43w+iwxaG0kqioJ0zojXyMnn/Iy01yQXx3ig2+2G6/WKSGcZLpeLjDw9JlmJdS2oaNf32LYgWvHvL8vyY3+DY/M8S41IqVTG7UiXngpY63CKE/n5b+qYpok0ZL2Y/x/+AWlhWDOvzFGoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"stp 300x113\" title=\"\" src=\"/static/ff48cb74b9263deae7b4ab5a3377ded7/5a46d/stp-300x113.png\" srcset=\"/static/ff48cb74b9263deae7b4ab5a3377ded7/4dcb9/stp-300x113.png 188w,\n/static/ff48cb74b9263deae7b4ab5a3377ded7/5a46d/stp-300x113.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<div><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* get Boemska data connector macros */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">%inc&nbsp;</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"SASEnvironment<span style=\"color: #000099;\">S</span>ASCode<span style=\"color: #000099;\">P</span><wbr>rograms<span style=\"color: #000099;\">h</span>54short.sas\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<br style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* load parameters (not actually used, just for demo) */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">%hfsGetDataset</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">SASControlTable<wbr>, work.controlparameters</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<br style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><span style=\"color: navy; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">data</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;groups;&nbsp;</span><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* grab all metadata groups */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">attrib</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;uriGrp uriMem GroupId GroupName Group_or_Role &nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">length</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=$64;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">attrib</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;GroupDesc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">length</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=$256;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">attrib</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;rcGrp rcMem rc i j&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">length</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: seagreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">3</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">call</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">missing</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">of&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">_all_</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">drop</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;uriGrp uriMem rcGrp rcMem rc i j Group_or_Role;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; i=</span><span style=\"color: seagreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">1</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;&nbsp;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; rcGrp=metadata_getnobj</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"<wbr>omsobj:IdentityGroup?@id contains '.'\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,i,uriGrp</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;&nbsp;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">do</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">while</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">rcGrp&gt;</span><span style=\"color: seagreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">0</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">call</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">missing</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">rcMem,uriMem,<wbr>GroupId,GroupName,Group_or_<wbr>Role</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; rc = metadata_getattr</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">uriGrp,</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"Id\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,<wbr>GroupId</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; rc = metadata_getattr</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">uriGrp,</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"Name\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><wbr>,GroupName</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; rc = metadata_getattr</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">uriGrp,</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"<wbr>PublicType\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,Group_or_Role</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; rc = metadata_getattr</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">uriGrp,</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"Desc\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><wbr>,GroupDesc</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;Group_or_Role =&nbsp;</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'UserGroup'</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">then</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">output</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; i+</span><span style=\"color: seagreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">1</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; &nbsp; rcGrp=metadata_getnobj</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #a020f0; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">\"<wbr>omsobj:IdentityGroup?@id contains '.'\"</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,i,uriGrp</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;&nbsp;</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp;&nbsp;</span><span style=\"color: blue; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">end</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"color: navy; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">run</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<br style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* send data back */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">%hfsHeader;&nbsp;</span><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* sets up the json */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; %hfsOutDataset</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">fromSAS,WORK, groups</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;&nbsp;</span><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* contains our desired data */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">&nbsp; %hfsOutDataset</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">justDemo,WORK, controlparameters</span><span style=\"color: #66cc66; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;&nbsp;</span><span style=\"color: darkgreen; font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">/* demo sending more data */</span>\n<span style=\"font-family: 'Courier New', Courier, monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">%hfsFooter;</span></div>\n&nbsp;\n<div></div>\n<div>The main thing to note about the above is that we are using the (free!) Boemska data connector (<a href=\"https://github.com/Boemska/h54s\">source code</a>). &nbsp;This makes it sooo easy to send / receive datasets from the browser, as well as being incredibly efficient (will send as many records as will fit in a 32k macro variable, then further macro variables as necessary). &nbsp;I do rate this piece of kit and will be doing a separate blog on it at some point.</div>\n<div></div>\n<div><b>Step 5 - upload all your files</b></div>\n<div></div>\n<div>Suggested locations:</div>\n<div>\n<ol>\n \t<li>example.html -&gt; &nbsp;ROOT.war/web &nbsp;(midtier)</li>\n \t<li>example.js -&gt; ROOT.war/js&nbsp;&nbsp;(midtier)</li>\n \t<li>jquery.js -&gt; ROOT.war/js&nbsp;&nbsp;(midtier)</li>\n \t<li>h54s.js -&gt; ROOT.war/js&nbsp;&nbsp;(midtier)</li>\n \t<li>example.sas -&gt; SASEnvironmentSASCodeStored_Processes &nbsp;(sasapp)</li>\n \t<li>h54short.sas -&gt;&nbsp;SASEnvironmentSASCodePrograms&nbsp;&nbsp;&nbsp;(sasapp)</li>\n</ol>\n<div>For the STP, I'd recommend creating a new sas metadata folder (eg&nbsp;<span style=\"font-family: 'Courier New', Courier, monospace;\">/Webapp/)</span>&nbsp;and putting all your web apps in that (for fine grained permissions control).</div>\n<div></div>\n<div><b>Step 6 - Open your latest SAS Web App!</b></div>\n</div>\n<div></div>\n<div>Example URL; &nbsp;<span style=\"font-family: Times, Times New Roman, serif;\">https://dev-sasmidtier.yourCompany.int:8080/web/example.html</span></div>\n<div></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32.97872340425532%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABPElEQVR42q1Oa4+CMBDk//+k+wVG7xRQQZBX5BFaSqEiIviYW8vlkvt+TaYzO7PZXUOerxBth4a4bi+omg6laJFzgYxVyJkAo7pqzjrjUqG7TriOT3S3u2aNaWbDDEosDyk+Pk18+QU2+wALJ9J65WXYxgL7k4QVcayo7+2bEYOTtYhLBSvmsN/wM+phMNp+Am97lI2CvExQqoOki6vzTddNf4caZkjqrbuRcCN/Qj+MEKQleW03oFIDjNVygTzPcHAc2NYGlmUjjEKwskQUBKg4x25rY71eU2YiT09wdnscXAcuwfc8BL4H2zTBGF2YxBFKxpEkCeIkRhhSTcOEqGlRoTlNM8RxAsd1SaeUMxRFoQccjwEyyt9LRC1hHMMQ0zTiv56hlMLj8dDF6/XSmLX+//i/+PH+ZM+ZvwEbwA9Z3qASRgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sas web apps\" title=\"\" src=\"/static/68348124207869945d1f4fa7c312cd5b/5a46d/example-300x99.png\" srcset=\"/static/68348124207869945d1f4fa7c312cd5b/4dcb9/example-300x99.png 188w,\n/static/68348124207869945d1f4fa7c312cd5b/5a46d/example-300x99.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\n<div>And that's it! &nbsp;If you've built web apps with SAS before, it's likely this approach will be unfamiliar. &nbsp;I mean, where are the put statements?! &nbsp;And why so many files?</div>\n<div></div>\n<div>Believe me, it may seem like a lot of configuration initially (although it isn't), but the benefits of this approach are HUGE.</div>\n<div>\n<ul>\n \t<li>Having separate CSS files (not in the demo) mean that styles can be quickly tweaked</li>\n \t<li>Having dedicated HTML files means that layouts can be easily be reconfigured</li>\n \t<li>Using the Boemska connector ensures that the application logic can be built with jquery / javascript, whilst the actual data management part can be cleanly separated and managed with SAS. &nbsp;Apart from tidy code, this also means that web developers and SAS developers can work alongside each other - <i>without having to know each other's craft. &nbsp;</i></li>\n \t<li>Serving html files direct from the web server means that functionality can be provided even when the SAS server is down, or slow</li>\n</ul>\n<div>Hopefully the above makes sense and is enough to get you started.&nbsp; A far more detailed guide is available in my SGF paper<a href=\"https://support.sas.com/resources/papers/proceedings17/1091-2017.pdf\"> Build Lightning Fast Web Apps with SAS</a>.&nbsp; </div>\n</div>\n<div></div>","frontmatter":{"title":"Building Web Apps with SAS","path":"/building-web-apps-with-sas/","previewImg":null,"tags":["sas web app"],"date":"Dec 30, 2015"}}},{"post":{"html":"<p>Occasionally when debugging it can be useful to run as a system account for checking permissions etc.<br /><br />A useful utility for this (in windows) is the “runas” command.  For instance (from the command window):<br /><br /><span style=\"font-family: Courier New, Courier, monospace;\">runas /user:“YourDomainsassrv” “C:Program FilesSASEnterpriseGuide4.3SEGuide.exe”</span><br /><br />or<br /><span style=\"font-family: Courier New, Courier, monospace;\"><br /></span><span style=\"font-family: Courier New, Courier, monospace;\">runas /user:”</span><span style=\"font-family: 'Courier New', Courier, monospace;\">YourDomain</span><span style=\"font-family: Courier New, Courier, monospace;\">sassrv” “C:Program Files (x86)Microsoft SQL Server120ToolsBinnManagementStudioSsms.exe”</span><br /><br />You will be prompted for the password before the client tool opens on your machine.<br /><br /><i>This post was inspired by the fact that one should not log into the application server as sassrv, to avoid conflicting / hung sessions in the STP server, but I can’t find the SAS note to back this up!  However those hung sessions were confirmed real.. </i> <b>Don’t log into sasapp as sassrv.</b></p>","frontmatter":{"title":"Running EG or other client tools as SASSRV","path":"/running-eg-or-other-client-tools-as-sassrv/","previewImg":null,"tags":["SQL"],"date":"Dec 18, 2015"}}},{"post":{"html":"<p>This one had me puzzled for a bit (SAS 9.2, Windows 2008, SQLNCLI10.1, OLEDB):<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: teal; font-family: &quot;Courier New&quot;;\">WARNING: The current setting of the DIRECT_EXE libname option will not allow this SQL statement to be passed directly to the DBMS for processing.</span></div><br />Explicitly setting the DIRECT_EXE option to DELETE had no effect.  Assigning the library in a new session, and performing the update also worked fine.  Thankfully the SYSCC variable was not affected, so jobs / processes continued to run, but still…<br /><br />Anyways, it turned out this was actually caused by the SASTRACE option!  Turning this OFF removed the warning.</p>","frontmatter":{"title":"DIRECT_EXE warning","path":"/direct_exe-warning/","previewImg":null,"tags":["SQL"],"date":"Oct 13, 2015"}}},{"post":{"html":"<p>Having seemingly brought down our 9.2 Windows 2008 STP server (only in DEV!!) during development of a yet another (awesome) STP web app, it occurred to me that more information was needed about just how many requests were being batted over.</p>\n<hr />\n<div style=\"color: red; font-family: 'trebuchet ms', arial, 'arial unicode ms', sans-serif; font-weight: bold;\">Stored Process Error</div><div style=\"font-family: 'trebuchet ms', arial, 'arial unicode ms', sans-serif; font-size: small;\">\n<h2 style=\"font-size: medium;\">Unable to execute stored process.</h2>\n<h2 style=\"font-size: medium;\">The server is not running (paused/deferred stop mode?).</h2></div>\n<hr />\nSo, inspired by Quentin McMullen's <a href=\"https://bi-notes.com/2014/02/sas_stored_process_log/\">excellent post</a>, I wanted to share my approach.\n<p><strong>Step 1</strong> was to create a table to log the events. This was structured as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token punctuation\">[</span>dbo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>STP_LOGGER<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>\n <span class=\"token punctuation\">[</span>PROCESSED_DTTM<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>datetime2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>STATUS_CD<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_PROGRAM<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_METAPERSON<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>SYSJOBID<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>_SESSIONID<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">[</span>GLOB_VARS<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span></code></pre></div>\n<p>Note that this table was not a SAS table (which could be subject to locking). If you have no other choice but to use a SAS table, please refer to the previous post for attempting SAS locks (noting that this <a href=\"/get-physical-path-from-metadata-libref\">cannot be done via the meta engine</a>).</p>\n<p><strong>Step 2</strong> was to create a <a href=\"https://github.com/sashub/macro/blob/master/standalone/stp_logger.sas\">macro</a> to update the table (to be placed somewhere in <a href=\"https://support.sas.com/documentation/cdl/en/hostwin/63285/HTML/default/viewer.htm#win-sysop-sasautos.htm\">SASAUTOS</a>). Example below:</p>\n<div class=\"gatsby-highlight\" data-language=\"sas\"><pre class=\"language-sas\"><code class=\"language-sas\"><span class=\"token macro-declaration\"><span class=\"token keyword\">%macro</span> stp_logger(status_cd=)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%local</span> global_vars<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">proc sql</span> noprint<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">select</span> <span class=\"token function keyword\">cats</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token string\">'='</span><span class=\"token punctuation\">,</span>value<span class=\"token punctuation\">)</span>\n    into: global_vars\n    separated <span class=\"token keyword\">by</span> <span class=\"token string\">'|'</span>\n    from dictionary<span class=\"token punctuation\">.</span>macros\n    <span class=\"token keyword\">where</span> scope <span class=\"token operator\">=</span> <span class=\"token string\">'GLOBAL'</span>\n    <span class=\"token keyword\">and</span> <span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator-keyword operator\">not</span> <span class=\"token function keyword\">in</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SQL'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SAS'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">and</span> <span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator-keyword operator\">ne</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function keyword\">%assign_lib</span><span class=\"token punctuation\">(</span>libref<span class=\"token operator\">=</span>web<span class=\"token punctuation\">)</span>\n\n  <span class=\"token step keyword\">proc datasets</span> library<span class=\"token operator\">=</span>work<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">delete</span> append<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">run</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">data</span> append <span class=\"token operator\">/</span>view<span class=\"token operator\">=</span>append<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token number\">0</span> <span class=\"token keyword\">then</span> <span class=\"token keyword\">set</span> web<span class=\"token punctuation\">.</span>stp_logger<span class=\"token punctuation\">;</span>\n    PROCESSED_DTTM<span class=\"token operator\">=</span><span class=\"token macro-keyword keyword\">%sysfunc</span><span class=\"token punctuation\">(</span><span class=\"token function keyword\">datetime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    STATUS_CD<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;status_cd\"</span><span class=\"token punctuation\">;</span>\n    _PROGRAM<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;_program\"</span><span class=\"token punctuation\">;</span>\n    _METAPERSON<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;_metaperson\"</span><span class=\"token punctuation\">;</span>\n    SYSJOBID<span class=\"token operator\">=</span><span class=\"token string\">\"&amp;sysjobid\"</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n  <span class=\"token macro-keyword keyword\">%if</span> <span class=\"token operator-keyword operator\">not</span> <span class=\"token macro-keyword keyword\">%symexist</span><span class=\"token punctuation\">(</span>_SESSIONID<span class=\"token punctuation\">)</span> <span class=\"token macro-keyword keyword\">%then</span> <span class=\"token macro-keyword keyword\">%do</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* session id is stored in the replay variable but needs to be extracted */</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_replay'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">subpad</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token function keyword\">index</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token string\">'_sessionid='</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token function keyword\">length</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    index<span class=\"token operator\">=</span><span class=\"token function keyword\">index</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token string\">'&amp;'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> index<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">then</span> index<span class=\"token operator\">=</span><span class=\"token function keyword\">length</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _replay<span class=\"token operator\">=</span><span class=\"token function keyword\">substr</span><span class=\"token punctuation\">(</span>_replay<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    _SESSIONID<span class=\"token operator\">=</span>_replay<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">drop</span> _replay index<span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%end</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%else</span> <span class=\"token macro-keyword keyword\">%do</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* explicitly created sessions are automatically available */</span>\n    _SESSIONID<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_SESSIONID'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token macro-keyword keyword\">%end</span><span class=\"token punctuation\">;</span>\n    GLOB_VARS<span class=\"token operator\">=</span><span class=\"token function keyword\">symget</span><span class=\"token punctuation\">(</span><span class=\"token string\">'global_vars'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">output</span><span class=\"token punctuation\">;</span>\n    stop<span class=\"token punctuation\">;</span>\n  <span class=\"token step keyword\">run</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">proc append</span> base<span class=\"token operator\">=</span>web<span class=\"token punctuation\">.</span>stp_logger <span class=\"token keyword\">data</span><span class=\"token operator\">=</span>append<span class=\"token punctuation\">;</span>run<span class=\"token punctuation\">;</span>\n\n  <span class=\"token step keyword\">proc sql</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">drop</span> view append<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro-end\"><span class=\"token keyword\">%mend</span> stp_logger</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><b>Step 3</b> was to call the macro.   The quick / dirty way would be to simply include it in the SAS programs directly, but that quickly becomes unmanageable when dealing with a large number of STPs.  Another option is to include in the autoexec, but that will only deal with program ENTRY (not exit).\nThe best approach, as endorsed by <a href=\"https://bi-notes.com/2014/02/sas_stored_process_log/#comment-1955\">Don Henderson</a>, is to use the STP init and term programs.  These are straightforward .sas programs that run on an STP session’s entry and exit.  Configuration is simple, and explained here:  <a href=\"https://support.sas.com/kb/39/250.html\"><a href=\"https://support.sas.com/kb/39/250.html\">https://support.sas.com/kb/39/250.html</a></a>.</p>\n<p>This approach is fantastic as it will ensure that ALL calls to the STP server are logged (eg via EG, AMO, WRS, every custom web app, etc etc).   Simply add the following one-liners to each file:</p>\n<div class=\"gatsby-highlight\" data-language=\"sas\"><pre class=\"language-sas\"><code class=\"language-sas\"><span class=\"token function keyword\">%stp_logger</span><span class=\"token punctuation\">(</span>status_cd<span class=\"token operator\">=</span>SrvEnter<span class=\"token punctuation\">)</span>  <span class=\"token comment\">/* goes in the init file */</span>\n<span class=\"token function keyword\">%stp_logger</span><span class=\"token punctuation\">(</span>status_cd<span class=\"token operator\">=</span>SrvExit<span class=\"token punctuation\">)</span>   <span class=\"token comment\">/* goes in the term file */</span></code></pre></div>\n<p>Boom, we are done, and here is an extract of the new logging table:</p>\n<p><img src=\"/45e987897554f08dfd95c1478cca7024/Capture_4.png\" alt=\"\"></p>\n<p>See that highlighted row?  A hung session with my name against it…</p>\n<p><img src=\"https://1.bp.blogspot.com/-iq3rv-RygCQ/VenmQacknMI/AAAAAAAAAlw/uz0v7PUwxQU/s320/2010-02-24-hangman.jpg\" alt=\"\"></p>\n<p><strong>EDIT 13OCT2015:</strong>\n<em>The connection issue was finally resolved by setting the <a href=\"https://support.sas.com/rnd/itech/doc9/admin_oma/sasserver/iombridge/sp_sercl.html#sasRecycleActivationLimit\">Recycle Activation Limit</a> to 1.  This had no noticeable effect on performance.</em></p>","frontmatter":{"title":"Event Logging of Stored Process Server Sessions","path":"/event-logging-of-stored-process-server-sessions/","previewImg":null,"tags":["SQL"],"date":"Sep 04, 2015"}}}]}},"pageContext":{"page":"index","archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3},"filter":{},"limit":10,"skip":50,"numPages":9,"currentPage":6}},"staticQueryHashes":["1133634862"],"slicesMap":{}}