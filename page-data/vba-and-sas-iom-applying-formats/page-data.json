{"componentChunkName":"component---src-templates-template-tsx","path":"/vba-and-sas-iom-applying-formats/","result":{"data":{"post":{"id":"8e8077ab-918a-5467-a738-14c07dc6de0c","html":"<p>Sample code (and tips) for applying SAS Formats to data before pulling into excel:<br /><br /><pre><span style=\"color: maroon; font-weight: bold;\">Dim</span> obConnection <span style=\"color: maroon; font-weight: bold;\">As</span> <span style=\"color: maroon; font-weight: bold;\">New</span> ADODB<span style=\"color: #008c00;\">.</span>Connection<br /><span style=\"color: maroon; font-weight: bold;\">Dim</span> obRecordSet <span style=\"color: maroon; font-weight: bold;\">As</span> <span style=\"color: maroon; font-weight: bold;\">New</span> ADODB<span style=\"color: #008c00;\">.</span>Recordset<br /><br /><span style=\"color: dimgrey;\">‘workspace (ws) object previously defined</span><br />obConnection<span style=\"color: #008c00;\">.</span><span style=\"color: maroon; font-weight: bold;\">Open</span> <span style=\"color: #0000e6;\">“provider=sas.iomprovider.1; Data Source=iom-id://”</span> <span style=\"color: #808030;\">+</span> ws<span style=\"color: #008c00;\">.</span>UniqueIdentifier<br /> <br /><span style=\"color: dimgrey;\">‘need to set the connection before the format property can be applied</span><br />obRecordSet<span style=\"color: #008c00;\">.</span>ActiveConnection <span style=\"color: #808030;\">=</span> obConnection<br /> <br /><span style=\"color: dimgrey;\">‘use “+<em>ALL</em>” to get both formatted AND unformatted values</span><br />obRecordSet<span style=\"color: #008c00;\">.</span>Properties<span style=\"color: #808030;\">(</span><span style=\"color: #0000e6;\">“SAS Formats”</span><span style=\"color: #808030;\">)</span> <span style=\"color: #808030;\">=</span> <span style=\"color: #0000e6;\">”<em>ALL</em>”</span><br /> <br /><span style=\"color: dimgrey;\">’ the second parameter below has to be EMPTY</span><br />obRecordSet<span style=\"color: #008c00;\">.</span><span style=\"color: maroon; font-weight: bold;\">Open</span> sasTable<span style=\"color: #808030;\">,</span> <span style=\"color: #808030;\">,</span> adOpenStatic<span style=\"color: #808030;\">,</span> adLockReadOnly<span style=\"color: #808030;\">,</span> ADODB<span style=\"color: #008c00;\">.</span>adCmdTableDirect<br /></pre></p>","frontmatter":{"title":"VBA and SAS IOM - applying formats","path":"/vba-and-sas-iom-applying-formats/","previewImg":null,"tags":["SQL"],"date":"Dec 29, 2014"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3,"2021":1,"2022":7,"2023":1,"2024":1,"2025":3}}},"staticQueryHashes":["1133634862"],"slicesMap":{}}